<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN//EN" 
	"http://www.springframework.org/dtd/spring-beans.dtd">

<beans>

	<!--   
		<bean id="messageRenderer" class="org.sakaiproject.assignment2.tool.beans.Assignments2MessageRenderer">
		<property name="messageLocator">
		<ref bean="messageLocator" />
		</property>
		<property name="infoStyleClass" value="success" />
		<property name="errorStyleClass" value="alertMessageInline" />
		</bean>
	-->

	<bean id="LocalPermissionLogic"
		class="org.sakaiproject.assignment2.tool.LocalPermissionLogic">
		<property name="permissionLogic"
			ref="org.sakaiproject.assignment2.logic.AssignmentPermissionLogic" />
		<property name="externalLogic"
			ref="org.sakaiproject.assignment2.logic.ExternalLogic" />
		<property name="submissionLogic"
			ref="org.sakaiproject.assignment2.logic.AssignmentSubmissionLogic" />
	</bean>

	<bean id="localAssignmentLogic"
		class="org.sakaiproject.assignment2.tool.LocalAssignmentLogic">
	</bean>

	<!-- Entity Providers -->
	<bean id="Assignment2DetailEntityProvider"
		class="org.sakaiproject.assignment2.tool.entity.Assignment2DetailEntityProvider"
		init-method="init" destroy-method="destroy">
		<property name="entityProviderManager"
			ref="org.sakaiproject.entitybroker.entityprovider.EntityProviderManager" />
	</bean>
	
	<!-- <bean parent="org.sakaiproject.entitybroker.entityprovider.AbstractEntityProvider"  
	    class="org.sakaiproject.assignment2.tool.entity.Assignment2EntityProvider">
		<property name="assignmentLogic" ref="org.sakaiproject.assignment2.logic.AssignmentLogic" />
	</bean> -->

	<!--  causes every variable to post, even if it hasn't changed since page render -->
	<bean id="ignoreFossilizedValues"
		class="uk.org.ponder.springutil.BooleanFactory">
		<property name="value" value="true" />
	</bean>

	<!-- handles configuration of internationalization messages -->
	<bean id="messageSource" parent="messageSourceParent">
      <property name="basename" value="classpath:/bundle/messages" />
    </bean>


	<bean id="Assignment2ViewParamsInterceptor"
				class="org.sakaiproject.assignment2.tool.Assignment2WorkFlowLogic">
		<property name="localPermissionLogic" ref="LocalPermissionLogic" />
	</bean>

	<!--  Handles incoming views to filter based on permissions  -->
	<bean parent="viewParamsInterceptorParent">
		<property name="value" ref="Assignment2ViewParamsInterceptor" />
	</bean>
	
	<bean parent="actionResultInterceptorParent">
    	<property name="value" ref="Assignment2ViewParamsInterceptor" />
 	</bean>
	

	<!-- Define the bean roots from the request scope file that are accessible 
		via incoming request URL -->
	<bean parent="requestAddressibleParent">
		<property name="value"
			value="AssignmentAuthoringOptionsFlowBean, AssignmentAuthoringBean, AssignmentAuthoringFlowBean, StudentSubmissionBean,RemoveAssignmentCommand,StudentSubmissionVersionFlowBean,GradeAllRemainingAction,MarkFeedbackAsReadAction,Assignment2,AssignmentSubmission,AssignmentSubmissionBean,FilePickerBean,AssignmentSubmissionVersion,UploadBean,MarkTodoBean,ReleaseGradesAction,ReleaseFeedbackAction,ReorderAssignmentsAction" />
	</bean>

	<!-- Override the default style of user messages -->
	<bean id="assignment2TemplateContributor"
		parent="templateContributorParent">
		<property name="baseDirectory" value="component-templates/" />
		<property name="templateNames"
			value="AsnnSubmissionRenderers,Pager,SortHeader,AttachmentList,GradebookDetails,StudentViewAssignment,AttachmentEvolver,MarkupEditor" />
	</bean>

	<!-- Override the default style of user messages -->
	<bean id="messageTemplateContributor"
		parent="templateContributorParent">
		<property name="baseDirectory" value="component-templates/" />
		<property name="templateNames" value="Messages" />
	</bean>

	<!-- Register the template "layout.html" as defining root layout for
		each page in the application (extension is auto-inferred from view type),
		base directory is defaulted from "defaultTemplatePath" -> content/templates/ -->
	<bean parent="rootTemplateContributorParent">
		<property name="templateNames" value="Layout" />
	</bean>

	<bean id="HTMLViewGroup" class="uk.org.ponder.rsf.view.ViewGroup">
		<property name="contentTypeSpec" value="HTML,HTML-FRAGMENT" />
	</bean>

	<!-- The beans listed here are session beans, currently we have none. :) -->
	<!-- 
	<bean id="myBeanScope" parent="beanScopeParent">
		<property name="copyPreservingBeans"
			value="" />
		<property name="exclusive" value="true" />
	</bean>
	-->
	
	  <!-- The beans which will be preserved across a flow via simple instance
			copying -->
	<bean parent="copyPreservingParent">
		<!-- <property name="value" value="UploadBean, Assignment2, AssignmentSubmissionVersion, AssignmentSubmissionBean, AssignmentSubmission"/> -->
	    <!-- Ugh, UploadBean still has request scope references as well. -->
	    <property name="value" value="UploadBean, StudentSubmissionVersionFlowBean, AssignmentAuthoringFlowBean, AssignmentAuthoringOptionsFlowBean"/>
	</bean>
	
	

	<bean id="Assignment2Creator"
		class="org.sakaiproject.assignment2.tool.beans.Assignment2Creator">
		<property name="externalLogic"
			ref="org.sakaiproject.assignment2.logic.ExternalLogic" />
		<property name="messageLocator" ref="messageLocator" />
	</bean>

	<bean id="Assignment2" parent="entityBeanLocatorParent">
		<property name="newMethod" value="Assignment2Creator.create" />
		<property name="fetchMethod"
			value="org\.sakaiproject\.assignment2\.logic\.AssignmentLogic.getAssignmentByIdWithAssociatedData" />
		<property name="saveMethod"
			value="org\.sakaiproject\.assignment2\.logic\.AssignmentLogic.saveAssignment" />
		<property name="removeMethod"
			value="org\.sakaiproject\.assignment2\.logic\.AssignmentLogic.deleteAssignment" />
	</bean>

	<bean id="AssignmentSubmissionCreator"
		class="org.sakaiproject.assignment2.tool.beans.AssignmentSubmissionCreator">
		<property name="externalLogic"
			ref="org.sakaiproject.assignment2.logic.ExternalLogic" />
	</bean>

	<bean id="AssignmentSubmission" parent="entityBeanLocatorParent">
		<property name="newMethod"
			value="AssignmentSubmissionCreator.create" />
		<property name="fetchMethod"
			value="org\.sakaiproject\.assignment2\.logic\.AssignmentSubmissionLogic.getAssignmentSubmissionById" />
		<property name="saveMethod"
			value="org\.sakaiproject\.assignment2\.logic\.AssignmentSubmissionLogic.saveAssignmentSubmission" />
		<property name="removeMethod"
			value="org\.sakaiproject\.assignment2\.logic\.AssignmentSubmissionLogic.deleteAssignmentSubmission" />
	</bean>

	<bean id="AssignmentSubmissionVersionCreator"
		class="org.sakaiproject.assignment2.tool.beans.AssignmentSubmissionVersionCreator">
	</bean>

	<bean id="AssignmentSubmissionVersion"
		parent="entityBeanLocatorParent">
		<property name="newMethod"
			value="AssignmentSubmissionVersionCreator.create" />
		<property name="fetchMethod"
			value="org\.sakaiproject\.assignment2\.logic\.AssignmentSubmissionLogic.getSubmissionVersionById" />
		<property name="saveMethod"
			value="org\.sakaiproject\.assignment2\.logic\.AssignmentSubmissionLogic.saveInstructorFeedback" />
	</bean>

	<bean parent="handlerHookParent">
		<property name="value">
			<bean parent="RSACBridgeProxy">
				<property name="targetBeanName" value="zipHandlerHook" />
			</bean>
		</property>
	</bean>

	<bean id="zipSubmissionsBean" parent="viewParamsRegistrarParent">
		<property name="viewID" value="zipSubmissions" />
		<property name="viewParamsClass"
			value="org.sakaiproject.assignment2.tool.params.ZipViewParams" />
	</bean>

	<!-- Use RSF's "BeanGuard" validation scheme to trap all write accesses to a
		Assignment2 entity -->
	<!-- 
		<bean parent="writeGuardParent">
		<property name="guardedPath" value="Assignment2.*" />
		<property name="guardMethod" value="Assignment2Validator.assignment" />
		</bean>
	-->
</beans>
